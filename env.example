# MCP Graph Memory Configuration
#
# Copy this file to `.env` in the root directory and adjust values.
# The server will automatically load this file on startup.

# =============================================================================
# Core Server Settings
# =============================================================================

# Enable/disable the server instance
MCP_SERVER_ENABLED=true

# Optional server metadata (displayed in MCP clients)
MCP_SERVER_NAME=memory
MCP_SERVER_DESCRIPTION="Memory MCP server for knowledge graph (FalkorDB)"

# =============================================================================
# Database Connection (FalkorDB)
# =============================================================================

FALKORDB_HOST=localhost
FALKORDB_PORT=6379
FALKORDB_GRAPH=memory
FALKORDB_PASSWORD=falkordb123

# =============================================================================
# Embeddings
# =============================================================================

# Model to use for embeddings (SentenceTransformers)
EMBEDDING_MODEL=intfloat/multilingual-e5-base

# =============================================================================
# Search & Graph Defaults
# =============================================================================

DEFAULT_SEARCH_LIMIT=10
SEMANTIC_SIMILARITY_THRESHOLD=0.55

# Auto-linking thresholds
AUTO_LINKING_SEMANTIC_THRESHOLD=0.75
NEIGHBOURS_SEARCH_THRESHOLD=0.8

# Subgraph exploration limits
SUBGRAPH_DEFAULT_DEPTH=1
SUBGRAPH_MAX_DEPTH=3
SUBGRAPH_DEFAULT_MAX_NODES=20
SUBGRAPH_MAX_NODES_LIMIT=50

# Duplicate detection
DUPLICATE_SIMILARITY_THRESHOLD=0.85
DUPLICATE_MAX_GROUP_SIZE=10
DUPLICATE_TOP_K=100

# Summarization
SUMMARY_SIMILARITY_THRESHOLD=0.7

# =============================================================================
# Maintenance & Logs
# =============================================================================

CLEANUP_DAYS_THRESHOLD=90
LOG_TTL_DAYS=10
LOG_CLEANUP_FREQUENCY=10

# =============================================================================
# Background Jobs (APScheduler)
# =============================================================================

# Master switch for background jobs
JOBS_ENABLED=false

# Job processing scope
# If true, jobs process all owners in the graph. If false, only `JOBS_OWNER_IDS`.
JOBS_PROCESS_ALL_OWNERS=false
JOBS_OWNER_IDS=default

# Job locking (in seconds)
JOBS_LOCK_TTL_SECONDS=600

# Job: Deduplicate Facts
JOB_DEDUPLICATE_ENABLED=false
JOB_DEDUPLICATE_CRON="0 * * * *"  # Run hourly
JOB_DEDUPLICATE_HOURS_THRESHOLD=24
JOB_DEDUPLICATE_SIMILARITY_THRESHOLD=0.95

# Job: Archive Old Facts
JOB_ARCHIVE_ENABLED=false
JOB_ARCHIVE_CRON="0 3 * * 0"  # Run weekly (Sunday 3am)

# Job Retry Policy
JOB_RETRY_MAX_ATTEMPTS=3
JOB_RETRY_BACKOFF_BASE=2.0
JOB_RETRY_BACKOFF_MAX=30.0

# =============================================================================
# Validation Limits
# =============================================================================

MAX_TEXT_LENGTH=10000
MAX_METADATA_SIZE=100000
MIN_TTL_DAYS=0.0
MAX_TTL_DAYS=3650.0

# =============================================================================
# Caching
# =============================================================================

CACHE_EMBEDDINGS_ENABLED=true
CACHE_EMBEDDINGS_MAXSIZE=1000

CACHE_SEARCH_ENABLED=true
CACHE_SEARCH_MAXSIZE=100
CACHE_SEARCH_TTL=60
